<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Vue3 文档笔记-基础篇 | Rush</title>
<meta name="keywords" content="vue3">
<meta name="description" content="笔记">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/vue3-docs-basic-notes/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/vue3-docs-basic-notes/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Rush (Alt + H)">Rush</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Vue3 文档笔记-基础篇
    </h1>
    <div class="post-description">
      笔记
    </div>
    <div class="post-meta"><span title='2022-01-18 05:29:32 +0000 UTC'>January 18, 2022</span>&nbsp;·&nbsp;5 min

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#basic" aria-label="Basic">Basic</a><ul>
                        
                <li>
                    <a href="#%e9%80%9a%e8%bf%87-createapp-%e5%88%9b%e5%bb%ba%e5%ba%94%e7%94%a8%e5%ae%9e%e4%be%8b" aria-label="通过 createApp 创建应用实例">通过 createApp 创建应用实例</a></li>
                <li>
                    <a href="#es6-proxy" aria-label="ES6 Proxy">ES6 Proxy</a></li>
                <li>
                    <a href="#%e8%ae%a1%e7%ae%97%e5%b1%9e%e6%80%a7-computed" aria-label="计算属性 computed">计算属性 computed</a></li>
                <li>
                    <a href="#%e4%be%a6%e5%90%ac%e5%99%a8-watch" aria-label="侦听器 watch">侦听器 watch</a></li>
                <li>
                    <a href="#class-%e4%b8%8e-style-%e7%9a%84%e7%bb%91%e5%ae%9a" aria-label="class 与 style 的绑定">class 与 style 的绑定</a><ul>
                        
                <li>
                    <a href="#class" aria-label="class">class</a></li>
                <li>
                    <a href="#style" aria-label="style">style</a></li></ul>
                </li>
                <li>
                    <a href="#v-for" aria-label="v-for">v-for</a></li>
                <li>
                    <a href="#%e4%ba%8b%e4%bb%b6%e5%a4%84%e7%90%86" aria-label="事件处理">事件处理</a></li>
                <li>
                    <a href="#v-model" aria-label="v-model">v-model</a></li></ul>
                </li>
                <li>
                    <a href="#component" aria-label="Component">Component</a><ul>
                        
                <li>
                    <a href="#%e5%9c%a8%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6%e4%b8%8a%e4%bd%bf%e7%94%a8-v-model" aria-label="在自定义组件上使用 v-model">在自定义组件上使用 v-model</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8-emits-%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6%e5%8f%91%e5%87%ba%e7%9a%84%e4%ba%8b%e4%bb%b6" aria-label="使用 emits 定义组件发出的事件">使用 emits 定义组件发出的事件</a></li>
                <li>
                    <a href="#%e6%8f%92%e6%a7%bd" aria-label="插槽">插槽</a></li>
                <li>
                    <a href="#provide--inject" aria-label="Provide / Inject">Provide / Inject</a></li></ul>
                </li>
                <li>
                    <a href="#composition-api" aria-label="Composition API">Composition API</a><ul>
                        
                <li>
                    <a href="#setup" aria-label="Setup">Setup</a><ul>
                        
                <li>
                    <a href="#props" aria-label="Props">Props</a></li>
                <li>
                    <a href="#context" aria-label="Context">Context</a></li>
                <li>
                    <a href="#provide--inject-1" aria-label="Provide / Inject">Provide / Inject</a></li>
                <li>
                    <a href="#%e6%a8%a1%e6%9d%bf%e5%bc%95%e7%94%a8" aria-label="模板引用">模板引用</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#mixin" aria-label="Mixin">Mixin</a></li>
                <li>
                    <a href="#teleport" aria-label="Teleport">Teleport</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p><strong>好记性不如烂笔头</strong></p>
<h2 id="basic">Basic<a hidden class="anchor" aria-hidden="true" href="#basic">#</a></h2>
<h3 id="通过-createapp-创建应用实例">通过 createApp 创建应用实例<a hidden class="anchor" aria-hidden="true" href="#通过-createapp-创建应用实例">#</a></h3>
<p>在 vue2.x 中，使用的是<code>new Vue()</code>，返回的是根组件实例，而<code>createApp</code>返回的是应用实例，想要得到根组件实例，还需要使用<code>mount</code>方法，个人认为这个改动是在语法层面上区分创建组件和创建应用</p>
<h3 id="es6-proxy">ES6 Proxy<a hidden class="anchor" aria-hidden="true" href="#es6-proxy">#</a></h3>
<p>vue2.x 使用 <code>Object.defineProperty</code>来实现数据相应，vue3 中使用 <code>new Proxy()</code>为数据架设一层代理，来实现数据响应</p>
<h3 id="计算属性-computed">计算属性 computed<a hidden class="anchor" aria-hidden="true" href="#计算属性-computed">#</a></h3>
<ul>
<li>计算属性会缓存结果，只要依赖值不变，多次访问该计算属性也不会执行代码，而是直接返回缓存结果，减小性能开销</li>
<li>计算属性拥有<code>getter</code>、<code>setter</code></li>
</ul>
<h3 id="侦听器-watch">侦听器 watch<a hidden class="anchor" aria-hidden="true" href="#侦听器-watch">#</a></h3>
<ul>
<li>watch 与 computed 几乎相同，唯一不同的是，watch 允许在其中执行异步操作</li>
</ul>
<h3 id="class-与-style-的绑定">class 与 style 的绑定<a hidden class="anchor" aria-hidden="true" href="#class-与-style-的绑定">#</a></h3>
<h4 id="class">class<a hidden class="anchor" aria-hidden="true" href="#class">#</a></h4>
<ul>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Vue" data-lang="Vue"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="o">:</span><span class="na">class</span><span class="o">=</span><span class="s">&#34;{active: isActive}&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="nt">:class</span><span class="o">=</span><span class="s">&#34;classes&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nx">data</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">classes</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">avtive</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="nx">container</span><span class="o">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="o">:</span><span class="na">class</span><span class="o">=</span><span class="s">&#34;[activeClass, containerClass]&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nx">data</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">activeClass</span><span class="o">:</span> <span class="s1">&#39;active&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">containerClass</span><span class="o">:</span> <span class="s1">&#39;container&#39;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
<li>
<p>也可以直接在<code>v-bind:class</code>中使用三运运算符来切换 class</p>
</li>
<li>
<p>在自定义组件上使用 class</p>
<ul>
<li>
<p>若组件内只有一个根元素，那么这些 class 会自动合并在根元素上</p>
</li>
<li>
<p>若有多个根元素，需要定义哪些根元素接收 class，使用<code>$attrs</code></p>
</li>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Vue" data-lang="Vue"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;app&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">my-component</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;baz&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">my-component</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">createApp</span><span class="p">({})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="s1">&#39;my-component&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">template</span><span class="o">:</span> <span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">    &lt;p :class=&#34;$attrs.class&#34;&gt;Hi!&lt;/p&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">    &lt;span&gt;This is a child component&lt;/span&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">  `</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>继承的 Attribute 可以使用<code>$arrts</code>来定义 Attribute 具体出现在哪个元素上</p>
<ul>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Vue" data-lang="Vue"><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="s1">&#39;date-picker&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">inheritAttrs</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">template</span><span class="o">:</span> <span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">    &lt;div class=&#34;date-picker&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">      &lt;input type=&#34;datetime-local&#34; v-bind=&#34;$attrs&#34; /&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">    &lt;/div&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">  `</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">&lt;!--</span><span class="nx">这样一来</span><span class="err">，</span><span class="nx">所有写在</span> <span class="nx">date</span><span class="o">-</span><span class="nx">picker</span> <span class="nx">上的</span> <span class="nx">attribute</span> <span class="nx">将会绑定在</span> <span class="nx">input</span> <span class="nx">元素上</span><span class="o">--&gt;</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<h4 id="style">style<a hidden class="anchor" aria-hidden="true" href="#style">#</a></h4>
<ul>
<li>
<p>对象语法</p>
<ul>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Vue" data-lang="Vue"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="o">:</span><span class="na">style</span><span class="o">=</span><span class="s">&#34;{color: &#39;red&#39;, fontSize: &#39;14px&#39;, borderRadius: borderRadius}&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">data</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">borderRadius</span><span class="o">:</span> <span class="s1">&#39;4px&#39;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>也可以直接绑定到一个样式对象</p>
<ul>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Vue" data-lang="Vue"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="nt">:style</span><span class="o">=</span><span class="s">&#34;styleObject&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">data</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">styleObject</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fontSize</span><span class="o">:</span> <span class="s1">&#39;14px&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="nx">borderRadius</span><span class="o">:</span> <span class="s1">&#39;4px&#39;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>	
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>数组语法</p>
<ul>
<li>
<p>可以使用数组语法包含多个样式对象</p>
</li>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Vue" data-lang="Vue"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="o">:</span><span class="na">style</span><span class="o">=</span><span class="s">&#34;[borderStyle, textStyle]&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">data</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">borderStyle</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">border</span><span class="o">:</span> <span class="s1">&#39;1px solid red&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="nx">borderRadius</span><span class="o">:</span> <span class="s1">&#39;4px&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="p">},</span>
</span></span><span class="line"><span class="cl">		<span class="nx">textStyle</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fontSize</span><span class="o">:</span> <span class="s1">&#39;14px&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;gray&#39;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<h3 id="v-for">v-for<a hidden class="anchor" aria-hidden="true" href="#v-for">#</a></h3>
<ul>
<li>
<p><code>v-if</code>的优先级高于<code>v-for</code>，当两个指令同时作用于一个元素身上时，你需要你知道你在干什么</p>
</li>
<li>
<blockquote>
<p>当 Vue 正在更新使用 <code>v-for</code> 渲染的元素列表时，它默认使用“就地更新”的策略。如果数据项的顺序被改变，Vue 将不会移动 DOM 元素来匹配数据项的顺序，而是就地更新每个元素，并且确保它们在每个索引位置正确渲染。</p>
</blockquote>
</li>
<li>
<p>用比较简单的描述是，如果 <code>v-for</code>渲染出来的列表没有绑定<code>key</code>，那么在<code>v-for</code>绑定值变化的时候，Vue 是基于绑定值的索引来更新 DOM 树的</p>
</li>
<li>
<p>查看这个<a href="https://codesandbox.io/s/vue-template-z5xud?fontsize=14">例子</a></p>
<ul>
<li>我们将三个 input 元素的值改为 test1、test2、test3</li>
<li>然后删除第二个元素，按照直觉来说，剩下的应该只有 test1 和 test3，但结果是 test1 和 test2，why?</li>
<li>很简单，我们改变了<code>v-for</code>绑定值的 index，之前是<code>0,1,2</code>，删除后是<code>0, 1</code>，相当于删除了索引为 2 的元素，那么在这个 list 对应的 DOM 树中，也会去删除索引为 2 的节点，所以反应到页面上是 test1 和 test2</li>
<li>这就是文档中所说的依赖子组件状态或临时DOM状态，在这种情况下我们需要绑定<code>key</code>值来明确地告诉 Vue 我们想要删除的节点到底是哪一个，而不是让索引做主</li>
</ul>
</li>
<li>
<p>为了让 Vue 可以监听到数组的变化，Vue 改写了以下数组方法：</p>
<ul>
<li>push</li>
<li>pop</li>
<li>shift</li>
<li>unshift</li>
<li>splice</li>
<li>sort</li>
<li>reverse</li>
</ul>
</li>
<li>
<p>代替变更方法更好的办法是直接替换数组</p>
</li>
</ul>
<h3 id="事件处理">事件处理<a hidden class="anchor" aria-hidden="true" href="#事件处理">#</a></h3>
<ul>
<li>
<p>在内联语句中使用<code>@eventName</code>这样的方法来处理事件</p>
<ul>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="nt">@click</span><span class="s">=&#34;f&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">methods</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// e这个参数我们在绑定事件回调函数的时候并没有传啊？that&#39;s ok，vue 会帮我们传的
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>   	<span class="c1">// 这样的写法，vue 会在调用回调函数时默认帮我们传一个 event 对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">f</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="err">@</span><span class="na">click</span><span class="o">=</span><span class="s">&#34;f(&#39;message&#39;, $event)&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">methods</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">f</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span><span class="nx">e</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 当我们需要其他参数时，并且还想接收到 event 对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// 我们需要在内联语句中显示的传递这个参数，使用 $event 这个变量，你问这个哪来的？去问 Evan You
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`message is </span><span class="si">${</span><span class="nx">message</span><span class="si">}</span><span class="sb">`</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>一个事件可以绑定多个回调函数，使用逗号分割</p>
<ul>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="err">@</span><span class="na">click</span><span class="o">=</span><span class="s">&#34;doOne($event), doTwo($event)&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>事件修饰符</p>
<ul>
<li>
<p><code>.stop</code>阻止事件冒泡</p>
</li>
<li>
<p><code>.prevent</code>阻止事件默认行为</p>
</li>
<li>
<p><code>.capture</code>使用事件捕获模式</p>
</li>
<li>
<p><code>.self</code>触发事件的元素只能是本身</p>
</li>
<li>
<p><code>.once</code>事件只会触发一次</p>
</li>
<li>
<p><code>.passive</code>文档解释我没太看懂，看了下 MDN，将 MDN 的解释照搬过来</p>
<ul>
<li>
<blockquote>
<p><code>passive</code>: <code>Boolean</code>，设置为true时，表示 <code>listener</code> 永远不会调用 <code>preventDefault()</code>。如果 listener 仍然调用了这个函数，客户端将会忽略它并抛出一个控制台警告。查看 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget/addEventListener#%E4%BD%BF%E7%94%A8_passive_%E6%94%B9%E5%96%84%E7%9A%84%E6%BB%9A%E5%B1%8F%E6%80%A7%E8%83%BD">使用 passive 改善的滚屏性能</a> 了解更多.</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h3 id="v-model">v-model<a hidden class="anchor" aria-hidden="true" href="#v-model">#</a></h3>
<ul>
<li><code>.lazy</code>会将触发事件由<code>input</code>改变为<code>change</code></li>
<li><code>.number</code>将输入值转变为<code>Number</code>类型</li>
<li><code>.trim</code>过滤输入值的首尾空白字符</li>
</ul>
</li>
</ul>
<h2 id="component">Component<a hidden class="anchor" aria-hidden="true" href="#component">#</a></h2>
<h3 id="在自定义组件上使用-v-model">在自定义组件上使用 v-model<a hidden class="anchor" aria-hidden="true" href="#在自定义组件上使用-v-model">#</a></h3>
<p><code>v-model</code>本质上是一个语法糖，当我们剥开包装纸，其实是这样的</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">custom-input</span>
</span></span><span class="line"><span class="cl">  <span class="na">v-model</span><span class="o">=</span><span class="s">&#34;searchText&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">&gt;&lt;/</span><span class="nt">custom-input</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">custom-input</span>
</span></span><span class="line"><span class="cl">  <span class="na">:model-value</span><span class="o">=</span><span class="s">&#34;searchText&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="err">@</span><span class="na">update:model-value</span><span class="o">=</span><span class="s">&#34;searchText = $event&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">&gt;&lt;/</span><span class="nt">custom-input</span><span class="p">&gt;</span>
</span></span></code></pre></div><blockquote>
<p>为了让它正常工作，这个组件内的 <code>&lt;input&gt;</code> 必须：</p>
<ul>
<li>将其 <code>value</code> attribute 绑定到一个名叫 <code>modelValue</code> 的 prop 上</li>
<li>在其 <code>input</code> 事件被触发时，将新的值通过自定义的 <code>update:modelValue</code> 事件抛出</li>
</ul>
</blockquote>
<p>当然，我们也可以自定这个值，并不一定是 <code>modelValue</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">input</span>
</span></span><span class="line"><span class="cl">      <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">:value</span><span class="o">=</span><span class="s">&#34;value&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="err">@</span><span class="na">input</span><span class="o">=</span><span class="s">&#34;$emit(&#39;update:xxx&#39;, $event.target.value)&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// props 接收一个名为 xxx 的 property
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">defineProps</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">xxx</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">type</span><span class="o">:</span> <span class="nb">String</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">required</span><span class="o">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>当然，我们也可以在内部的<code>input</code>上使用<code>v-model</code>，不过需要改变一下写法，这里直接照搬文档</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="s1">&#39;custom-input&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">props</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;xxx&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">emits</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;update:xxx&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">template</span><span class="o">:</span> <span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">    &lt;input v-model=&#34;value&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">  `</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">computed</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">value</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">get</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">modelValue</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nx">set</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">&#39;update:modelValue&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></div><h3 id="使用-emits-定义组件发出的事件">使用 emits 定义组件发出的事件<a hidden class="anchor" aria-hidden="true" href="#使用-emits-定义组件发出的事件">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="s1">&#39;custom-form&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">emits</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;inFocus&#39;</span><span class="p">,</span> <span class="s1">&#39;submit&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></div><p>当在 <code>emits</code> 选项中定义了原生事件 (如 <code>click</code>) 时，将使用组件中的事件<strong>替代</strong>原生事件侦听器。</p>
<ul>
<li>
<p>这句话的意思是，如果我们在一个自定义组件内使用<code>emits</code>定义了组件发出的事件，那么在该组件上定义相同的事件（也就是原生事件侦听器）将不会触发，而是改用组件内定义的事件触发</p>
</li>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">MyButton</span> <span class="nx">from</span> <span class="s1">&#39;./components/MyButton.vue&#39;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span><span class="nx">ref</span><span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;vue&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">f</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;customize element tigger&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">MyButton</span> <span class="na">label</span><span class="o">=</span><span class="s">&#34;click me&#34;</span> <span class="nt">@click</span><span class="s">=&#34;f&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">MyButton</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="line"><span class="cl"><span class="c">&lt;!--</span> <span class="nx">MyButton</span><span class="p">.</span><span class="nx">vue</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">button</span>  <span class="nt">@click</span><span class="s">=&#34;f&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">{{</span> <span class="na">label</span> <span class="p">}}</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nx">defineProps</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">label</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">type</span><span class="o">:</span> <span class="nb">String</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">required</span><span class="o">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">f</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;component click tigger&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 如果没有使用emits，那么我们点击这个按钮将会触发两次click
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">defineEmits</span><span class="p">([</span><span class="s1">&#39;click&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span></code></pre></div></li>
<li>
<p>在 2.x 中，如果 <code>MyButton</code> 组件上定义了监听了 click 事件，但是组件内部没有对其处理的话，是触发不了这个事件的，必须使用<code>.native</code>才能触发</p>
<ul>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="line"><span class="cl"><span class="c">&lt;!--</span> <span class="nx">MyButton</span><span class="p">.</span><span class="nx">vue</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">button</span><span class="p">&gt;</span><span class="nx">click</span> <span class="nx">me</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">my-button</span> <span class="err">@</span><span class="na">click</span><span class="o">=</span><span class="s">f</span><span class="p">&gt;&lt;/</span><span class="nt">my-button</span><span class="p">&gt;</span>
</span></span></code></pre></div></li>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">methods</span><span class="o">:</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 这个f是不会被触发的，除非是组件内部对click做出反应抛出一个click事件，或者在组件上使用 .native 修饰符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// .native 会将组件上的事件监听绑定到组件内部的根元素上
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">f</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;tigger&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<p><code>emits</code>还可以验证抛出事件</p>
<blockquote>
<p>要添加验证，请为事件分配一个函数，该函数接收传递给 <code>$emit</code> 调用的参数，并返回一个布尔值以指示事件是否有效。</p>
</blockquote>
<ul>
<li>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">emits</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 没有验证
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">click</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 验证 submit 事件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nx">submit</span><span class="o">:</span> <span class="p">({</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">})</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">email</span> <span class="o">&amp;&amp;</span> <span class="nx">password</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s1">&#39;Invalid submit event payload!&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="插槽">插槽<a hidden class="anchor" aria-hidden="true" href="#插槽">#</a></h3>
<p>备用内容/默认内容：</p>
<ul>
<li>可以给插槽指定默认内容，当父组件在使用该组件时且并未提供任何插槽内容，默认内容将会被渲染</li>
</ul>
<p>具名插槽：</p>
<ul>
<li>给<code>slot</code>标签添加一个<code>name</code>的 Attribute，然后在父组件中使用<code>&lt;template v-slot:slotName&gt;</code>指定使用哪一个插槽，<code>slot</code>没有<code>name</code>的会当作<code>default</code></li>
<li>插槽的名称也可以使用<a href="https://v3.cn.vuejs.org/guide/template-syntax.html#%E5%8A%A8%E6%80%81%E5%8F%82%E6%95%B0">动态指令参数</a></li>
<li>具名插槽还可以使用缩写，但只能在有其他参数时使用（有多个插槽且需要提供名称时），将<code>v-sot</code>替换为<code>#</code>，使用缩写是需要使用明确的插槽名</li>
</ul>
<p>作用域插槽</p>
<ul>
<li>让父组件能够访问子组件通过插槽暴露的数据</li>
<li>子组件：<code>&lt;slot :dataName=data&gt;&lt;/slot&gt;</code>，父组件通过<code>v-slot:default=&quot;slotProps&quot;</code>来访问，<code>slotProps</code>是一个对象，里面包含了子组件插槽所暴露的数据项，<code>default</code>表示这是默认插槽，参考上面的具名插槽</li>
<li>当然，我们还可以使用<code>ES6</code>的解构语法：<code>v-slot:default={dataName}</code></li>
</ul>
<h3 id="provide--inject">Provide / Inject<a hidden class="anchor" aria-hidden="true" href="#provide--inject">#</a></h3>
<p>相当于“长距离 props”，子组件并不需要知道 inject 的 property 来自哪里，父组件也不需要知道哪些子组件使用了它 provide 的 property。</p>
<p>provide 要访问组件实例的 property 需要将 provide 写为一个返回对象的函数</p>
<p>provide 传递的内容并不是响应式的，我们可以使用 <code>computed</code> 来做到响应式</p>
<h2 id="composition-api">Composition API<a hidden class="anchor" aria-hidden="true" href="#composition-api">#</a></h2>
<p>这个算是Vue3 的最大更新了，这个 composition api 让我感觉 Vue3 现在确实是一个 framework，而不是一个 library，composition api 允许我们分离逻辑代码，使得<strong>单文件组件</strong>中的逻辑更加清晰有条理，在以往的 options api 中，如果我们有一个较重的组件，里面的<code>data</code>可能包含十多个 property，<code>methods</code>中的方法可能每一个都包含N行代码，阅读十分困难，而且逻辑关联不清楚。</p>
<h3 id="setup">Setup<a hidden class="anchor" aria-hidden="true" href="#setup">#</a></h3>
<p><code>setup</code>函数接收两个参数：</p>
<ul>
<li><code>props</code></li>
<li><code>context</code></li>
</ul>
<h4 id="props">Props<a hidden class="anchor" aria-hidden="true" href="#props">#</a></h4>
<p>与 options api 的 props 一样，它是响应式的。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">props</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">title</span><span class="o">:</span> <span class="nb">String</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nx">setup</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">title</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><blockquote>
<p>但是，因为 <code>props</code> 是响应式的，你<strong>不能使用 ES6 解构</strong>，它会消除 prop 的响应性。</p>
</blockquote>
<p>如果要解构 prop，需要使用<code>toRefs</code>函数来完成</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">toRefs</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">setup</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">{</span> <span class="nx">title</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">toRefs</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">title</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>如果<code>title</code>是可选的prop（required: false），那么传入的<code>props</code>中可能没有这个<code>titile</code>，这种情况<code>toRefs</code>不会创建一个ref，需要使用<code>toRef</code>替代它</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">import</span> <span class="p">{</span> <span class="nx">toRef</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">setup</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">toRef</span><span class="p">(</span><span class="nx">props</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">title</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="context">Context<a hidden class="anchor" aria-hidden="true" href="#context">#</a></h4>
<p>传递给 <code>setup</code> 函数的第二个参数是 <code>context</code>。<code>context</code> 是一个普通 JavaScript 对象，暴露了其它可能在 <code>setup</code> 中有用的值：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">setup</span><span class="p">(</span><span class="nx">props</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Attribute (非响应式对象，等同于 $attrs)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">attrs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 插槽 (非响应式对象，等同于 $slots)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">slots</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 触发事件 (方法，等同于 $emit)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">emit</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 暴露公共 property (函数)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">expose</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>context是一个普通的 JavaScript 对象， 可以使用解构</p>
<h4 id="provide--inject-1">Provide / Inject<a hidden class="anchor" aria-hidden="true" href="#provide--inject-1">#</a></h4>
<p>在 composition api 中，provide 需要从 vue 中 import，其次 provide 变为一个函数，接收连个参数：key，value</p>
<p>inject 相同，接收两个参数：需要 inject 的 property 的 key，默认值（可选）</p>
<p>为了使 provide 和 inject 的值具有响应性，需要在 provide 时使用<code>ref</code>或<code>reactive</code></p>
<p>对于响应式的 property，尽量在 provide 处进行修改，跟 props 的单向数据流相似。如果需要在 inject 处更新 property，可以通过 provide 暴露一个更新方法。</p>
<h4 id="模板引用">模板引用<a hidden class="anchor" aria-hidden="true" href="#模板引用">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span> 
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">ref</span><span class="o">=</span><span class="s">&#34;root&#34;</span><span class="p">&gt;</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">root</span> <span class="nx">element</span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">import</span> <span class="p">{</span> <span class="nx">ref</span><span class="p">,</span> <span class="nx">onMounted</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">root</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nx">onMounted</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// DOM 元素将在初始渲染后分配给 ref
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">root</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="c1">// &lt;div&gt;This is a root element&lt;/div&gt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">root</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span></code></pre></div><p><code>watch()</code>和<code>watchEffect()</code>在 DOM 挂载或更新<strong>之前</strong>运行，所以在这里面运行时，模板引用还未更新，可以使用选项<code>{flush: 'post'}</code>，这将在 DOM 更新后运行，确保模板引用和 DOM 保持同步。</p>
<h2 id="mixin">Mixin<a hidden class="anchor" aria-hidden="true" href="#mixin">#</a></h2>
<p>mixin 对象的所有选项将被“混合”入组件本身</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">myMixin</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">created</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">hello</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nx">methods</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">hello</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;hello from mixin!&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 定义一个使用此 mixin 对象的应用
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">createApp</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">mixins</span><span class="o">:</span> <span class="p">[</span><span class="nx">myMixin</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">mount</span><span class="p">(</span><span class="s1">&#39;#mixins-basic&#39;</span><span class="p">)</span> <span class="c1">// =&gt; &#34;hello from mixin!&#34;
</span></span></span></code></pre></div><ul>
<li>当组件和 mixin 对象拥有同名选项时，这些选项将会合并
<ul>
<li>data 返回对象中的 property 重名，将会以组件自身数据优先合并</li>
<li>钩子函数将会合并为一个数组，并依次调用，mixin的钩子<strong>先于</strong>组件钩子调用</li>
<li>其他值为对象的选项重名时，将会合并，对象中的 property 重名时，以组件自身的 property 优先</li>
</ul>
</li>
</ul>
<p>mixin 也可以全局注册，但会影响每一个创建的组件，谨慎使用</p>
<h2 id="teleport">Teleport<a hidden class="anchor" aria-hidden="true" href="#teleport">#</a></h2>
<p>允许我们控制在 DOM 中哪个父节点下渲染 HTML，一个例子时 toast 组件的 content 部分，我们希望他是基于<code>body</code>定位的，在vue2 中我是通过模板引用拿到元素，然后将其<code>append</code>到<code>body</code>中，现在 teleport 可以直接让我们将 content 部分传送到<code>body</code>标签下：<code>&lt;teleport to=&quot;body&quot;&gt;组件内容&lt;/teleport&gt;</code></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/vue3/">Vue3</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/people-talking-about-grand-narratives/">
    <span class="title">« Prev</span>
    <br>
    <span>谈论宏大叙事的人们</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/publish-yourself-npm-package/">
    <span class="title">Next »</span>
    <br>
    <span>康复训练之 Vue2 UI 库开发总结</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>© 2024 by Rush</span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
